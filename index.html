<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Omnipay-alipay by lokielse</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Omnipay-alipay</h1>
      <h2 class="project-tagline">Alipay driver for the Omnipay PHP payment processing library PHP 5.5+</h2>
      <a href="https://github.com/lokielse/omnipay-alipay" class="btn">View on GitHub</a>
      <a href="https://github.com/lokielse/omnipay-alipay/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/lokielse/omnipay-alipay/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="omnipay-alipay" class="anchor" href="#omnipay-alipay" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Omnipay: Alipay</h1>

<p><strong>Alipay driver for the Omnipay PHP payment processing library</strong></p>

<p><a href="https://travis-ci.org/lokielse/omnipay-alipay"><img src="https://travis-ci.org/lokielse/omnipay-alipay.png?branch=master" alt="Build Status"></a>
<a href="https://packagist.org/packages/lokielse/omnipay-alipay"><img src="https://poser.pugx.org/lokielse/omnipay-alipay/version.png" alt="Latest Stable Version"></a>
<a href="https://packagist.org/packages/lokielse/omnipay-alipay"><img src="https://poser.pugx.org/lokielse/omnipay-alipay/d/total.png" alt="Total Downloads"></a></p>

<p><a href="https://github.com/omnipay/omnipay">Omnipay</a> is a framework agnostic, multi-gateway payment
processing library for PHP 5.3+. This package implements Alipay support for Omnipay.</p>

<blockquote>
<p>Cross-border Alipay payment please use <a href="https://github.com/lokielse/omnipay-global-alipay"><code>lokielse/omnipay-global-alipay</code></a></p>
</blockquote>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>Omnipay is installed via <a href="http://getcomposer.org/">Composer</a>. To install, simply add it to your <code>composer.json</code> file:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>require<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>lokielse/omnipay-alipay<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>dev-master<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p>And run composer to update your dependencies:</p>

<pre><code>$ curl -s http://getcomposer.org/installer | php
$ php composer.phar update
</code></pre>

<h2>
<a id="basic-usage" class="anchor" href="#basic-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Basic Usage</h2>

<p>The following gateways are provided by this package:</p>

<ul>
<li>Alipay_Express (Alipay Express Checkout) 支付宝即时到账接口</li>
<li>Alipay_Secured (Alipay Secured Checkout) 支付宝担保交易接口</li>
<li>Alipay_Dual (Alipay Dual Function Checkout) 支付宝双功能交易接口</li>
<li>Alipay_WapExpress (Alipay Wap Express Checkout) 支付宝WAP客户端接口</li>
<li>Alipay_MobileExpress (Alipay Mobile Express Checkout) 支付宝无线支付接口</li>
<li>Alipay_Bank (Alipay Bank Checkout) 支付宝网银快捷接口</li>
</ul>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="purchase" class="anchor" href="#purchase" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Purchase</h3>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$gateway</span> <span class="pl-k">=</span> <span class="pl-c1">Omnipay</span><span class="pl-k">::</span>create(<span class="pl-s"><span class="pl-pds">'</span>Alipay_Express<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setPartner(<span class="pl-s"><span class="pl-pds">'</span>8888666622221111<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setKey(<span class="pl-s"><span class="pl-pds">'</span>your**key**here<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setSellerEmail(<span class="pl-s"><span class="pl-pds">'</span>merchant@example.com<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setReturnUrl(<span class="pl-s"><span class="pl-pds">'</span>http://www.example.com/return<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setNotifyUrl(<span class="pl-s"><span class="pl-pds">'</span>http://www.example.com/notify<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//For 'Alipay_MobileExpress', 'Alipay_WapExpress'</span></span>
<span class="pl-s1"><span class="pl-c">//$gateway-&gt;setPrivateKey('/such-as/private_key.pem');</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$options</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>out_trade_no<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">date</span>(<span class="pl-s"><span class="pl-pds">'</span>YmdHis<span class="pl-pds">'</span></span>) <span class="pl-k">.</span> <span class="pl-c1">mt_rand</span>(<span class="pl-c1">1000</span>,<span class="pl-c1">9999</span>), <span class="pl-c">//your site trade no, unique</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>subject<span class="pl-pds">'</span></span>      <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>test<span class="pl-pds">'</span></span>, <span class="pl-c">//order title</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>total_fee<span class="pl-pds">'</span></span>    <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>0.01<span class="pl-pds">'</span></span>, <span class="pl-c">//order total fee</span></span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$response</span> <span class="pl-k">=</span> <span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>purchase(<span class="pl-smi">$options</span>)<span class="pl-k">-&gt;</span>send();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$response</span><span class="pl-k">-&gt;</span>getRedirectUrl();</span>
<span class="pl-s1"><span class="pl-smi">$response</span><span class="pl-k">-&gt;</span>getRedirectData();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//For 'Alipay_MobileExpress'</span></span>
<span class="pl-s1"><span class="pl-c">//Use the order string with iOS or Android SDK</span></span>
<span class="pl-s1"><span class="pl-smi">$response</span><span class="pl-k">-&gt;</span>getOrderString();</span></pre></div>

<h3>
<a id="returnnotify" class="anchor" href="#returnnotify" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Return/Notify</h3>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$gateway</span> <span class="pl-k">=</span> <span class="pl-c1">Omnipay</span><span class="pl-k">::</span>create(<span class="pl-s"><span class="pl-pds">'</span>Alipay_Express<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setPartner(<span class="pl-s"><span class="pl-pds">'</span>8888666622221111<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setKey(<span class="pl-s"><span class="pl-pds">'</span>your**key**here<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>setSellerEmail(<span class="pl-s"><span class="pl-pds">'</span>merchant@example.com<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">//For 'Alipay_MobileExpress', 'Alipay_WapExpress'</span></span>
<span class="pl-s1"><span class="pl-c">//$gateway-&gt;setAlipayPublicKey('/such-as/alipay_public_key.pem');</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$options</span> <span class="pl-k">=</span> [</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>request_params<span class="pl-pds">'</span></span><span class="pl-k">=&gt;</span> <span class="pl-c1">array_merge</span>(<span class="pl-smi">$_POST</span>, <span class="pl-smi">$_GET</span>), <span class="pl-c">//Don't use $_REQUEST for may contain $_COOKIE</span></span>
<span class="pl-s1">];</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$response</span> <span class="pl-k">=</span> <span class="pl-smi">$gateway</span><span class="pl-k">-&gt;</span>completePurchase(<span class="pl-smi">$options</span>)<span class="pl-k">-&gt;</span>send();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">if</span> (<span class="pl-smi">$response</span><span class="pl-k">-&gt;</span>isPaid()) {</span>
<span class="pl-s1"></span>
<span class="pl-s1">   <span class="pl-c">// Paid success, your statements go here.</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">   <span class="pl-c">//For notify, response 'success' only please.</span></span>
<span class="pl-s1">   <span class="pl-c">//die('success');</span></span>
<span class="pl-s1">} <span class="pl-k">else</span> {</span>
<span class="pl-s1"></span>
<span class="pl-s1">   <span class="pl-c">//For notify, response 'fail' only please.</span></span>
<span class="pl-s1">   <span class="pl-c">//die('fail');</span></span>
<span class="pl-s1">}</span></pre></div>

<p>For general usage instructions, please see the main <a href="https://github.com/omnipay/omnipay">Omnipay</a>
repository.</p>

<h2>
<a id="related" class="anchor" href="#related" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Related</h2>

<ul>
<li><a href="https://github.com/ignited/laravel-omnipay">Laravel-Omnipay</a></li>
<li><a href="https://github.com/lokielse/omnipay-global-alipay">Omnipay-GlobalAlipay</a></li>
<li><a href="https://github.com/lokielse/omnipay-wechatpay">Omnipay-WechatPay</a></li>
<li><a href="https://github.com/lokielse/omnipay-unionpay">Omnipay-UnionPay</a></li>
</ul>

<h2>
<a id="support" class="anchor" href="#support" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support</h2>

<p>If you are having general issues with Omnipay, we suggest posting on
<a href="http://stackoverflow.com/">Stack Overflow</a>. Be sure to add the
<a href="http://stackoverflow.com/questions/tagged/omnipay">omnipay tag</a> so it can be easily found.</p>

<p>If you want to keep up to date with release anouncements, discuss ideas for the project,
or ask more detailed questions, there is also a <a href="https://groups.google.com/forum/#!forum/omnipay">mailing list</a> which
you can subscribe to.</p>

<p>If you believe you have found a bug, please report it using the <a href="https://github.com/lokielse/omnipay-alipay/issues">GitHub issue tracker</a>,
or better yet, fork the library and submit a pull request.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/lokielse/omnipay-alipay">Omnipay-alipay</a> is maintained by <a href="https://github.com/lokielse">lokielse</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
